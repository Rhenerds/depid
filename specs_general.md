# DEPID General Specifications

## Abstract
This repository defines DEPIDs (Detached Embedded-Proof IDentifiers), a 128 bit long decentral-oriented identifier intended to allow mathematically guaranteed instance-to-instance uniqueness while allowing source attribution without a central identifier registry.
It utilizes prime-field divisibility to allow receivers to identify the origin (issuer) of a DEPID in O(1) time.

## Copyright Notice
Copyright (c) 2026 Rhendra Networking. All rights reserved. Under the MIT License.

## 1. Introduction
A DEPID is 128 bits long and only requires a master list defining the primes attributed to each a source. A source may have a many-to-one relationship with a prime while a prime must have a one-to-one relationship with a source.

## 2. Motivation
Existing identifiers depend on a central registry to prevent collisions, where two identical identifiers are generated by two separate sources of a single space.
Other than that, in certain applications a lookup is also needed to find the source of such identifier.

DEPIDs are generated by multiplying a randomly generated hex of a certain length with a large prime number, then folding the resultant of it. Afterwards a hint is generated based on the associated prime then appended to the resultant to form the final DEPID. Folding ensures resilience towards GCD attacks while the hint minimizes the set of primes to unfold and modulo for source attribution.

## 3. Format
The DEPID format is 16 octets (128 bits) in size. Unlike standard UUIDs, which reserve multiple bits for variants and versions, DEPID utilizes a **Compact Versioning** strategy to maximize algebraic entropy.

### 3.1. Binary Layout

Bit definitions start at 0 (MSB) and end at 127 (LSB). The 128-bit field is partitioned into three logical segments:

1. **Hint (H):** Bits 0 through 7 (Octet 0).
2. **Version (V):** Bits 8 through 11 (High nibble of Octet 1).
3. **Payload (K):** Bits 12 through 127.

| Field | Octet | Bits | Description |
| --- | --- | --- | --- |
| **Hint** | 0 | 0-7 | 8-bit Keyed Hint for O(1) source routing. |
| **Version** | 1 | 8-11 | 4-bit Version identifier (). |
| **Payload** | 1-15 | 12-127 | 116-bit Algebraic/Entropy field. |

### 3.2. String Representation

DEPID utilizes a fixed-length "hex-and-dash" representation. To maintain 128-bit density within a 32-character hexadecimal string, the dashes act as visual delimiters for the logical fields but do not represent additional data.

The formal ABNF for the DEPID string is:

```abnf
DEPID    = 2hexOctet "-" 1HEXDIG "-" 29HEXDIG
hexOctet = HEXDIG HEXDIG
HEXDIG   = DIGIT / "A" / "B" / "C" / "D" / "E" / "F"
```

**Example DEPID v2:**
`0A-2-F39C12847B1029384756A10293847`

* **0A**: Hint ()
* **2**: Version ()
* **F39C...**: Payload ()

### 3.3. Version 3 Layout

DEPID v3 embeds a timestamp for lexicographical ordering. The layout is as follows:

| Field | Octet |Bits | Description |
| --- | --- | --- | --- |
| Hint (H) | 0 | 0–7 |8-bit Keyed Hint for O(1) source routing. |
| Version (V) | 1 | 8–11 | 4-bit Version identifier (Fixed at 0x3). |
| Timestamp (T) | 1–5 | 12–43 | 32-bit Unsigned Unix Timestamp (Seconds). |
| Algebraic (K) | 5–15 | 44–127 | 84-bit Prime-Aligned Algebraic Entropy. |

### 3.4. Version Field

The version nibble (bits 8-11) allows for 16 distinct protocols ( through ). This allows the processing logic to change (e.g., shifting from Prime-Modulo to a different algebraic curve) without altering the 128-bit footprint.

| Version | Description |
| --- | --- |
| **0x0** | Reserved / Nil DEPID. |
| **0x1** | Legacy Algebraic (v1.x). |
| **0x2** | Two-Keyed-Masking (v2.x). |
| **0x3** | Two-Keyed-Masking with Embedded Timestamp (v3.x). |
| **0x4-0xE** | Reserved for future definition. |
| **0xF** | Max / Experimental DEPID. |

This specification outlines the mathematical and structural foundations of the **DEPID (Detached Embedded Proof Identifier)** system, specifically focusing on the **Algebraic Basis** used across all versions, including the logic originally established in internal **v2.3** (now rebranded for external consistency).

---

## 4. Algebraic Basis

The core of the DEPID protocol is the mapping of a high-entropy "Naked ID" into a verifiable prime field. By ensuring the payload is a multiple of a source-specific prime $P$ , we enable decentralized verification without a central registry. Usage of primes ensure global uniqueness is achievable with minimal shared knowledge.

### 4.1. The Prime Space

All source identifiers (Primes) are selected from a sparse set of primes within a specific bit-range to ensure uniqueness and prevent collision.

* **Bit-Range**: DEPID utilizes **20-bit primes** ($0x10000 ≤ P ≤ 0xFFFFF$).
* **Sparsity**: The system traditionally skips every few primes (3 for v1, keyed cryptographically secure pseudorandom for v2 and onwards) within this range to ensure a sparse distribution, resulting in approximately 18,000 authorized possibilities.

### 4.2. Prime-Field Alignment

To create the Verifiable ID ($D$), a high-entropy Naked ID ($Q$) is shifted to create a "remainder window" and then aligned to the nearest multiple of the issuer's assigned prime .

The alignment is defined by the following mechanism:

$D = (Q≪20)−((Q≪20) \mod P)$


**Key Properties:**

* **Divisibility**: $D$ is guaranteed to be a multiple of $P (D ≡ 0 (mod P))$.
* **Entropy Preservation**: The 20-bit shift ensures that the remainder subtraction never touches or alters the original high-entropy bits of $Q$.
* **Constraint**: The resulting $D$ must fit within the specified payload length for the version (e.g., 120 bits for v2.x).

### 4.3. Masking and Keyed-Folding

To prevent "Prime Recovery" or Greatest Common Divisor (GCD) attacks on intercepted tokens, the Verifiable ID ($D$) is obfuscated using a deterministic XOR mask.

The masked payload X is generated as:

$X = D ⊕ fold{_L} ​(P)$

The folding function, $fold{_L}$, derives a deterministic bitstream of length $L$ from the 20-bit prime.

* **v2.x (Internal v2.3)**: Uses a payload length $L$ = 120 bits.
* **v3.x (Temporal)**: Uses a payload length $L$ = 84 bits (accounting for the 32-bit timestamp and 4-bit version nibble).

### 4.4. Verification Complexity

On v2 and onwards, unauthorized parties without access to the processing keys or the authorized sparse prime set face O(N) brute-force complexity. However, an authorized receiver uses a **Scattered Hint ()** to perform **Subset Selection**.

1. **Hint Extraction**: The receiver extracts H from the first 8 bits of the token.
2. **Keyed Lookup**: The receiver queries a pre-computed inverse map to find candidate primes $P{_j}$ associated with that specific hint.
3. **O(1) Resolution**: By testing only the small subset of primes in that "bucket," the receiver identifies the source in constant time.

---

### 4.5. Anti-Collision Mechanisms

To guarantee that no DEPIDs generated collide locally or globally, the generation process must adhere to the following three verification layers:

* Continually Progressing Entropy: The generation must use a continually progressing entropy source to generate the Naked ID ($Q$) such as a counter or a timestamp. It is also recommended to generate using a cryptographically secure pseudorandom number generator (CSPRNG).
* Database Collision Check: The system must check for identical DEPIDs within the local database before final issuance to prevent accidental duplication. While the probability of a 100-bit (v2.x) or 64-bit (v3.x) collision is mathematically negligible ($\approx 2^{-100}$ or $2^{-64}$ per second), this serves as a final "fail-safe" for high-availability clusters.
* Cross-Prime Attribution Check (False Positive Filtering): The system must check if a generated DEPID can be attributed to other primes within the subset of primes belonging to the same hint-derived bucket.

The "Bucket Collision" Rule: Because multiple primes may map to the same 8-bit Hint ($H$), there is a micro-probability that a value $D$ intended for Prime $P_a$ is also divisible by Prime $P_b$ within that same bucket66. The generator must verify that $D \pmod{P_j} = 0$ is only true for the intended issuer's prime.

### 4.6. Summary of Variable Bit-Lengths

| Operation | v2.x (Hardened) | v3.x (Temporal) |
| --- | --- | --- |
| **Shift Offset** | 20 bits | 20 bits |
| **Entropy (Q) bits** | 100 bits | 64 bits |
| **Resulting D Length** | 120 bits | 84 bits |
| **Final Hex Chars (K)** | 30 chars | 21 chars |


---

For further detailed information regarding versions, please view the version-specified specifications.